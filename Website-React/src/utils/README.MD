# IPFS å·¥å…·å‡½æ•°è¯´æ˜æ–‡æ¡£

æœ¬æ–‡æ¡£è§£é‡Šäº† `ipfs.ts` ä¸­ä½¿ç”¨çš„å…³é”®æ¦‚å¿µå’Œ APIã€‚

---

## ğŸ“š ç›®å½•

- [async function](#async-function)
- [FormData](#formdata)
- [HTTP è¯·æ±‚æ–¹æ³• (method)](#http-è¯·æ±‚æ–¹æ³•-method)
- [HTTP è¯·æ±‚å¤´ (headers)](#http-è¯·æ±‚å¤´-headers)
- [è®¤è¯æ–¹æ¡ˆ (Authorization)](#è®¤è¯æ–¹æ¡ˆ-authorization)

---

## async function

**å¼‚æ­¥å‡½æ•°**ï¼Œç”¨äºå¤„ç†éœ€è¦ç­‰å¾…çš„æ“ä½œï¼ˆå¦‚ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å–ï¼‰ã€‚è®©å‡½æ•°å¯ä»¥æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼Œä¸ä¼šé˜»å¡å…¶ä»–ä»£ç ã€‚

### âŒ é”™è¯¯ç¤ºä¾‹

```typescript
// è¿™æ ·å†™ä¼šé˜»å¡æ•´ä¸ªç¨‹åº
function uploadFile() {
  const response = fetch('https://api.example.com/upload')  // éœ€è¦å‡ ç§’é’Ÿ
  return response  // ä½† response è¿˜æ²¡å‡†å¤‡å¥½ï¼
}
```

### âœ… æ­£ç¡®ç¤ºä¾‹

```typescript
// ä½¿ç”¨ async/await
async function uploadFile() {
  const response = await fetch('https://api.example.com/upload')  // ç­‰å¾…å®Œæˆ
  const data = await response.json()  // å†ç­‰å¾…è§£æ
  return data  // ç°åœ¨æ•°æ®å‡†å¤‡å¥½äº†
}
```

### ä½¿ç”¨ await ç­‰å¾…å¼‚æ­¥æ“ä½œ

```typescript
async function example() {
  // await ä¼šç­‰å¾… fetch å®Œæˆ
  const response = await fetch('https://api.example.com')
  
  // await ä¼šç­‰å¾… JSON è§£æå®Œæˆ
  const data = await response.json()
  
  // ç°åœ¨å¯ä»¥ä½¿ç”¨ data äº†
  console.log(data)
}
```

---

## FormData

`FormData` æ˜¯ä¸€ä¸ª Web APIï¼Œç”¨äºåˆ›å»ºç±»ä¼¼ HTML è¡¨å•çš„æ•°æ®æ ¼å¼ï¼Œç‰¹åˆ«é€‚åˆä¸Šä¼ æ–‡ä»¶ã€‚

### åŸºæœ¬ç”¨æ³•

```typescript
const formData = new FormData()
formData.append('file', file)
```

- `'file'`ï¼šå­—æ®µåï¼ˆæœåŠ¡å™¨æœŸæœ›çš„å­—æ®µåï¼‰
- `file`ï¼šè¦ä¸Šä¼ çš„æ–‡ä»¶å¯¹è±¡

### âŒ é”™è¯¯ç¤ºä¾‹

```typescript
// ä¸èƒ½ç›´æ¥å‘é€æ–‡ä»¶å¯¹è±¡
fetch('https://api.example.com/upload', {
  method: 'POST',
  body: file  // è¿™æ ·ä¸è¡Œï¼
})
```

### âœ… æ­£ç¡®ç¤ºä¾‹

```typescript
// ä½¿ç”¨ FormData
const formData = new FormData()
formData.append('file', file)

fetch('https://api.example.com/upload', {
  method: 'POST',
  body: formData  // ç°åœ¨å¯ä»¥äº†ï¼
})
```

---

## HTTP è¯·æ±‚æ–¹æ³• (method)

`method` æŒ‡å®šè¦æ‰§è¡Œçš„ HTTP æ“ä½œç±»å‹ã€‚

### å¸¸è§çš„ HTTP æ–¹æ³•

| æ–¹æ³• | è¯´æ˜ | ç”¨é€” |
|------|------|------|
| `GET` | è·å–æ•°æ® | ä»æœåŠ¡å™¨è¯»å–ä¿¡æ¯ï¼ˆé»˜è®¤æ–¹æ³•ï¼‰ |
| `POST` | æäº¤æ•°æ® | å‘æœåŠ¡å™¨å‘é€æ•°æ®ï¼ˆå¦‚ä¸Šä¼ æ–‡ä»¶ï¼‰ |
| `PUT` | æ›´æ–°æ•°æ® | æ›´æ–°æœåŠ¡å™¨ä¸Šçš„èµ„æº |
| `DELETE` | åˆ é™¤æ•°æ® | åˆ é™¤æœåŠ¡å™¨ä¸Šçš„èµ„æº |
| `PATCH` | éƒ¨åˆ†æ›´æ–° | éƒ¨åˆ†æ›´æ–°èµ„æº |

### ä½¿ç”¨ç¤ºä¾‹

```typescript
// GET - è·å–æ•°æ®
fetch('https://api.example.com/users')

// POST - å‘é€æ•°æ®
fetch('https://api.example.com/upload', {
  method: 'POST',
  body: formData
})
```

---

## HTTP è¯·æ±‚å¤´ (headers)

`headers` åŒ…å«è¯·æ±‚çš„å…ƒæ•°æ®ï¼Œå‘Šè¯‰æœåŠ¡å™¨å¦‚ä½•å¤„ç†è¯·æ±‚ã€‚

### å¸¸è§çš„è¯·æ±‚å¤´

| è¯·æ±‚å¤´ | è¯´æ˜ | ä¾‹å­ |
|--------|------|------|
| `Authorization` | èº«ä»½è®¤è¯ | `Bearer token123` |
| `Content-Type` | æ•°æ®ç±»å‹ | `application/json` |
| `Accept` | æœŸæœ›çš„å“åº”ç±»å‹ | `application/json` |
| `User-Agent` | å®¢æˆ·ç«¯ä¿¡æ¯ | æµè§ˆå™¨è‡ªåŠ¨æ·»åŠ  |

### ä½¿ç”¨ç¤ºä¾‹

```typescript
fetch('https://api.example.com/data', {
  method: 'POST',
  headers: {
    'Authorization': 'Bearer token123',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({ name: 'å¼ ä¸‰' })
})
```

---

## è®¤è¯æ–¹æ¡ˆ (Authorization)

ä¸åŒçš„ API ä½¿ç”¨ä¸åŒçš„è®¤è¯æ–¹æ¡ˆæ ¼å¼ã€‚

### è®¤è¯æ–¹æ¡ˆå¯¹æ¯”

| è®¤è¯æ–¹æ¡ˆ | æ ¼å¼ | ç”¨é€” |
|---------|------|------|
| `Bearer` | `Bearer <token>` | JWTã€OAuth 2.0 token |
| `Basic` | `Basic <base64>` | ç”¨æˆ·åå¯†ç  |
| `Digest` | `Digest ...` | æ‘˜è¦è®¤è¯ |
| `Custom` | è‡ªå®šä¹‰æ ¼å¼ | æŸäº› API çš„ç‰¹æ®Šæ ¼å¼ |

### Bearer Token ä½¿ç”¨ç¤ºä¾‹

```typescript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨ Bearer å‰ç¼€
headers: {
  'Authorization': `Bearer ${jwtToken}`
}
// å‘é€: Authorization: Bearer eyJhbGciOiJIUzI1NiIs...

// âŒ é”™è¯¯ï¼šç¼ºå°‘ Bearer å‰ç¼€
headers: {
  'Authorization': jwtToken  // æœåŠ¡å™¨ä¸çŸ¥é“è¿™æ˜¯ä»€ä¹ˆæ ¼å¼
}
```

### ä¸ºä»€ä¹ˆéœ€è¦ `Bearer` å‰ç¼€ï¼Ÿ

- `Bearer` å‘Šè¯‰æœåŠ¡å™¨è¿™æ˜¯ Bearer token æ ¼å¼
- ç©ºæ ¼æ˜¯æ ‡å‡†æ ¼å¼è¦æ±‚çš„åˆ†éš”ç¬¦
- `${apiToken}` æ˜¯å®é™…çš„è®¤è¯å‡­è¯
- è¿™æ˜¯ OAuth 2.0 å’Œ JWT çš„è¡Œä¸šæ ‡å‡†æ ¼å¼

---

## ğŸ“ ç›¸å…³æ–‡ä»¶

- `ipfs.ts` - IPFS ä¸Šä¼ å·¥å…·å‡½æ•°å®ç°
- `ImageUploader.tsx` - ä½¿ç”¨è¿™äº›å‡½æ•°çš„ç»„ä»¶ç¤ºä¾‹

---

## ğŸ”— å‚è€ƒèµ„æº

- [MDN - async function](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/async_function)
- [MDN - FormData](https://developer.mozilla.org/zh-CN/docs/Web/API/FormData)
- [MDN - fetch API](https://developer.mozilla.org/zh-CN/docs/Web/API/Fetch_API)
- [OAuth 2.0 Bearer Token](https://oauth.net/2/bearer-tokens/)
